<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Mad (mad.Mad)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">mad</a> &#x00BB; Mad</nav><header class="odoc-preamble"><h1>Module <code><span>Mad</span></code></h1><p>* Functions for decoding mp3 files using the libmad. * * </p><ul class="at-tags"><li class="author"><span class="at-tag">author</span> Samuel Mimram</li></ul></header><nav class="odoc-toc"><ul><li><a href="#exceptions">Exceptions</a></li><li><a href="#decoding-files">Decoding files</a></li></ul></nav><div class="odoc-content"><h2 id="exceptions"><a href="#exceptions" class="anchor"></a>Exceptions</h2><div class="odoc-spec"><div class="spec exception anchored" id="exception-Mad_error"><a href="#exception-Mad_error" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Mad_error</span> <span class="keyword">of</span> string</span></code></div><div class="spec-doc"><p>An error occured with libmad.</p></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Read_error"><a href="#exception-Read_error" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Read_error</span> <span class="keyword">of</span> string</span></code></div><div class="spec-doc"><p>An error occured while reading a file.</p></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-End_of_stream"><a href="#exception-End_of_stream" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">End_of_stream</span></span></code></div><div class="spec-doc"><p>The end of the mp3 stream was reached.</p></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Openfile_error"><a href="#exception-Openfile_error" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Openfile_error</span> <span class="keyword">of</span> string</span></code></div><div class="spec-doc"><p>Could not open a file.</p></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Closefile_error"><a href="#exception-Closefile_error" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Closefile_error</span> <span class="keyword">of</span> string</span></code></div><div class="spec-doc"><p>Could not close a file.</p></div></div><h2 id="decoding-files"><a href="#decoding-files" class="anchor"></a>Decoding files</h2><div class="odoc-spec"><div class="spec type anchored" id="type-mad_file"><a href="#type-mad_file" class="anchor"></a><code><span><span class="keyword">type</span> mad_file</span></code></div><div class="spec-doc"><p>An mp3 file opened for decoding.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-mpeg_layer"><a href="#type-mpeg_layer" class="anchor"></a><code><span><span class="keyword">type</span> mpeg_layer</span><span> = </span></code><ol><li id="type-mpeg_layer.Layer_I" class="def variant constructor anchored"><a href="#type-mpeg_layer.Layer_I" class="anchor"></a><code><span>| </span><span><span class="constructor">Layer_I</span></span></code></li><li id="type-mpeg_layer.Layer_II" class="def variant constructor anchored"><a href="#type-mpeg_layer.Layer_II" class="anchor"></a><code><span>| </span><span><span class="constructor">Layer_II</span></span></code></li><li id="type-mpeg_layer.Layer_III" class="def variant constructor anchored"><a href="#type-mpeg_layer.Layer_III" class="anchor"></a><code><span>| </span><span><span class="constructor">Layer_III</span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-emphasis"><a href="#type-emphasis" class="anchor"></a><code><span><span class="keyword">type</span> emphasis</span><span> = </span></code><ol><li id="type-emphasis.None" class="def variant constructor anchored"><a href="#type-emphasis.None" class="anchor"></a><code><span>| </span><span><span class="constructor">None</span></span></code></li><li id="type-emphasis.MS_50_15" class="def variant constructor anchored"><a href="#type-emphasis.MS_50_15" class="anchor"></a><code><span>| </span><span><span class="constructor">MS_50_15</span></span></code></li><li id="type-emphasis.CCITT_J_17" class="def variant constructor anchored"><a href="#type-emphasis.CCITT_J_17" class="anchor"></a><code><span>| </span><span><span class="constructor">CCITT_J_17</span></span></code></li><li id="type-emphasis.Reserved" class="def variant constructor anchored"><a href="#type-emphasis.Reserved" class="anchor"></a><code><span>| </span><span><span class="constructor">Reserved</span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-channel_mode"><a href="#type-channel_mode" class="anchor"></a><code><span><span class="keyword">type</span> channel_mode</span><span> = </span></code><ol><li id="type-channel_mode.Single_channel" class="def variant constructor anchored"><a href="#type-channel_mode.Single_channel" class="anchor"></a><code><span>| </span><span><span class="constructor">Single_channel</span></span></code></li><li id="type-channel_mode.Dual_channel" class="def variant constructor anchored"><a href="#type-channel_mode.Dual_channel" class="anchor"></a><code><span>| </span><span><span class="constructor">Dual_channel</span></span></code></li><li id="type-channel_mode.Joint_stereo" class="def variant constructor anchored"><a href="#type-channel_mode.Joint_stereo" class="anchor"></a><code><span>| </span><span><span class="constructor">Joint_stereo</span></span></code></li><li id="type-channel_mode.Stereo" class="def variant constructor anchored"><a href="#type-channel_mode.Stereo" class="anchor"></a><code><span>| </span><span><span class="constructor">Stereo</span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-frame_format"><a href="#type-frame_format" class="anchor"></a><code><span><span class="keyword">type</span> frame_format</span><span> = </span><span>{</span></code><ol><li id="type-frame_format.layer" class="def record field anchored"><a href="#type-frame_format.layer" class="anchor"></a><code><span>layer : <a href="#type-mpeg_layer">mpeg_layer</a>;</span></code></li><li id="type-frame_format.mode" class="def record field anchored"><a href="#type-frame_format.mode" class="anchor"></a><code><span>mode : <a href="#type-channel_mode">channel_mode</a>;</span></code></li><li id="type-frame_format.emphasis" class="def record field anchored"><a href="#type-frame_format.emphasis" class="anchor"></a><code><span>emphasis : <a href="#type-emphasis">emphasis</a>;</span></code></li><li id="type-frame_format.bitrate" class="def record field anchored"><a href="#type-frame_format.bitrate" class="anchor"></a><code><span>bitrate : int;</span></code></li><li id="type-frame_format.samplerate" class="def record field anchored"><a href="#type-frame_format.samplerate" class="anchor"></a><code><span>samplerate : int;</span></code></li><li id="type-frame_format.channels" class="def record field anchored"><a href="#type-frame_format.channels" class="anchor"></a><code><span>channels : int;</span></code></li><li id="type-frame_format.samples_per_channel" class="def record field anchored"><a href="#type-frame_format.samples_per_channel" class="anchor"></a><code><span>samples_per_channel : int;</span></code></li><li id="type-frame_format.original" class="def record field anchored"><a href="#type-frame_format.original" class="anchor"></a><code><span>original : bool;</span></code></li><li id="type-frame_format.copyright" class="def record field anchored"><a href="#type-frame_format.copyright" class="anchor"></a><code><span>copyright : bool;</span></code></li><li id="type-frame_format.private_bit" class="def record field anchored"><a href="#type-frame_format.private_bit" class="anchor"></a><code><span>private_bit : bool;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-read"><a href="#type-read" class="anchor"></a><code><span><span class="keyword">type</span> read</span><span> = <span>bytes <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p>Type for abstract reader.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-openfile"><a href="#val-openfile" class="anchor"></a><code><span><span class="keyword">val</span> openfile : <span>string <span class="arrow">&#45;&gt;</span></span> <a href="#type-mad_file">mad_file</a></span></code></div><div class="spec-doc"><p>* Open an mp3 file. * * </p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <a href="#exception-Openfile_error"><code>Openfile_error</code></a> <p>if an error occured while trying to open the file.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-openstream"><a href="#val-openstream" class="anchor"></a><code><span><span class="keyword">val</span> openstream : <span><a href="#type-read">read</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-mad_file">mad_file</a></span></code></div><div class="spec-doc"><p>* <code>openstream read_func</code> opens a stream where <code>read_func n</code> should be a * function which returns <code>n</code> bytes of data or less, the second component of * the result being the number of bytes to read in the fist component.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-skip_id3tags"><a href="#val-skip_id3tags" class="anchor"></a><code><span><span class="keyword">val</span> skip_id3tags : <span><span class="label">read</span>:<a href="#type-read">read</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">seek</span>:<span>(<span>int <span class="arrow">&#45;&gt;</span></span> int)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">tell</span>:<span>(<span>unit <span class="arrow">&#45;&gt;</span></span> int)</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>* Skip ID3 tags that may be present at * the beginning of a stream. This function * may be used to a mp3 file opened using <code>openstream</code>. * ID3 tags are always skipped when using <code>openfile</code>. * * <code>seek</code> is a callback to seek to an absolute * position on the encoded data, and <code>tell</code> a callback * to fetch the current position. <code>read</code> is the reading * callback.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-close"><a href="#val-close" class="anchor"></a><code><span><span class="keyword">val</span> close : <span><a href="#type-mad_file">mad_file</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>* Close an mp3 file previously opened with <code>openfile</code>. * * </p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <a href="#exception-Closefile_error"><code>Closefile_error</code></a> <p>if an error occured while trying to close the file.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_current_position"><a href="#val-get_current_position" class="anchor"></a><code><span><span class="keyword">val</span> get_current_position : <span><a href="#type-mad_file">mad_file</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p>* Get the current position (in bytes) of the decoder in the mp3 file which * should have been opened with <code>openfile</code>.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-time_unit"><a href="#type-time_unit" class="anchor"></a><code><span><span class="keyword">type</span> time_unit</span><span> = </span></code><ol><li id="type-time_unit.Hours" class="def variant constructor anchored"><a href="#type-time_unit.Hours" class="anchor"></a><code><span>| </span><span><span class="constructor">Hours</span></span></code></li><li id="type-time_unit.Minutes" class="def variant constructor anchored"><a href="#type-time_unit.Minutes" class="anchor"></a><code><span>| </span><span><span class="constructor">Minutes</span></span></code></li><li id="type-time_unit.Seconds" class="def variant constructor anchored"><a href="#type-time_unit.Seconds" class="anchor"></a><code><span>| </span><span><span class="constructor">Seconds</span></span></code></li><li id="type-time_unit.Deciseconds" class="def variant constructor anchored"><a href="#type-time_unit.Deciseconds" class="anchor"></a><code><span>| </span><span><span class="constructor">Deciseconds</span></span></code></li><li id="type-time_unit.Centiseconds" class="def variant constructor anchored"><a href="#type-time_unit.Centiseconds" class="anchor"></a><code><span>| </span><span><span class="constructor">Centiseconds</span></span></code></li><li id="type-time_unit.Milliseconds" class="def variant constructor anchored"><a href="#type-time_unit.Milliseconds" class="anchor"></a><code><span>| </span><span><span class="constructor">Milliseconds</span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_current_time"><a href="#val-get_current_time" class="anchor"></a><code><span><span class="keyword">val</span> get_current_time : <span><a href="#type-mad_file">mad_file</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-time_unit">time_unit</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p>* Get the current time position (in the given unit) of the decoder.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-decode_frame"><a href="#val-decode_frame" class="anchor"></a><code><span><span class="keyword">val</span> decode_frame : <span><a href="#type-mad_file">mad_file</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Decode an mp3 frame. * Returned data in interleaved when * there are two channels, and mono data * when there is only one.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-decode_frame_float"><a href="#val-decode_frame_float" class="anchor"></a><code><span><span class="keyword">val</span> decode_frame_float : <span><a href="#type-mad_file">mad_file</a> <span class="arrow">&#45;&gt;</span></span> <span><span>float array</span> array</span></span></code></div><div class="spec-doc"><p>Decode an mp3 frame.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-decode_frame_floatarray"><a href="#val-decode_frame_floatarray" class="anchor"></a><code><span><span class="keyword">val</span> decode_frame_floatarray : <span><a href="#type-mad_file">mad_file</a> <span class="arrow">&#45;&gt;</span></span> <span>floatarray array</span></span></code></div><div class="spec-doc"><p>Decode an mp3 frame.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-decode_frame_float_ba"><a href="#val-decode_frame_float_ba" class="anchor"></a><code><span><span class="keyword">val</span> decode_frame_float_ba : 
  <span><a href="#type-mad_file">mad_file</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(float, <span class="xref-unresolved">Stdlib</span>.Bigarray.float32_elt, <span class="xref-unresolved">Stdlib</span>.Bigarray.c_layout)</span>
    <span class="xref-unresolved">Stdlib</span>.Bigarray.Array1.t</span>
    array</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-skip_frame"><a href="#val-skip_frame" class="anchor"></a><code><span><span class="keyword">val</span> skip_frame : <span><a href="#type-mad_file">mad_file</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Skip one frame. The current time/position is * updated but the frame is not decoded.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_frame_format"><a href="#val-get_frame_format" class="anchor"></a><code><span><span class="keyword">val</span> get_frame_format : <span><a href="#type-mad_file">mad_file</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-frame_format">frame_format</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_output_format"><a href="#val-get_output_format" class="anchor"></a><code><span><span class="keyword">val</span> get_output_format : <span><a href="#type-mad_file">mad_file</a> <span class="arrow">&#45;&gt;</span></span> int * int * int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-duration"><a href="#val-duration" class="anchor"></a><code><span><span class="keyword">val</span> duration : <span>string <span class="arrow">&#45;&gt;</span></span> float</span></code></div><div class="spec-doc"><p>Compute the duration of a file, in seconds. * Never raises any exception, but returns 0. in case of error.</p></div></div></div></body></html>
